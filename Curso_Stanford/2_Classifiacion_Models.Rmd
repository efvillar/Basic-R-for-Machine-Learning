---
title: "Clasificacion"
author: "Edwin Villarraga"
date: "2 de julio de 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{R}
library(ISLR)  #libreria que contiene los datos
names(Smarket)  #muestra los datos de la tabla Smarket
#?Smarket  
pairs(Smarket, col=Smarket$Direction)  #grafica todas las variables en pares

```
## Regresión Logística

```{R}
glm.fit=glm(Direction~.-Today -Year, data=Smarket, family=binomial)
summary(glm.fit)

```


```{R}
glm.probs=predict(glm.fit, type="response")
glm.probs[1:6]
```

```{R}
glm.pred = ifelse(glm.probs>0.5,"Up","Down")
```
```{R}
attach(Smarket)
table(glm.pred, Direction)
mean(glm.pred==Direction)
```

##Se realizará la separación de una muestra de entrenamiento y una de prueba

```{R}
train = Year < 2005
glm.fit=glm(Direction~. - Today - Year, family = binomial, 
    data = Smarket, subset=train)
glm.probs=predict(glm.fit, newdata=Smarket[!train,], type="response")
glm.pred=ifelse(glm.probs>0.5,"Up","Down")
Direction.2005 = Smarket$Direction[!train]
table(glm.pred, Direction.2005)
mean(glm.pred==Direction.2005)
```
